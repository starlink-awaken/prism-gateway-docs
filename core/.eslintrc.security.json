{
  "$schema": "https://json.schemastore.org/eslintrc",
  "extends": [
    "plugin:security/recommended"
  ],
  "plugins": ["security", "no-secrets"],
  "parser": "@typescript-eslint/parser",
  "parserOptions": {
    "ecmaVersion": "latest",
    "sourceType": "module",
    "project": "./tsconfig.json"
  },
  "rules": {
    "security/detect-buffer-noassert": "error",
    "security/detect-child-process": "warn",
    "security/detect-disable-mustache-escape": "error",
    "security/detect-eval-with-expression": "error",
    "security/detect-no-csrf-before-method-override": "error",
    "security/detect-non-literal-fs-filename": "warn",
    "security/detect-non-literal-regexp": "warn",
    "security/detect-non-literal-require": "warn",
    "security/detect-object-injection": "warn",
    "security/detect-possible-timing-attacks": "warn",
    "security/detect-pseudoRandomBytes": "error",
    "no-secrets/secrets": "error"
  },
  "settings": {
    "no-secrets": {
      "additionalRegexes": [
        {
          "pattern": "(?i)(?:password|passwd|pwd|secret|api[_-]?key|token|private[_-]?key|auth[_-]?token)\\s*[=:]\\s*['\\\"]([a-zA-Z0-9._~!@#$%^&*(){};:?+=]{8,})['\\\"]",
          "flags": "gi",
          "message": "检测到可能的硬编码敏感信息"
        },
        {
          "pattern": "(?i)(?:aws[_-]?(?:access[_-]?)?key[_-]?id|secret[_-]?access[_-]?key)\\s*[=:]\\s*['\\\"]([A-Z0-9]{20})['\\\"]",
          "flags": "gi",
          "message": "检测到可能的 AWS 凭证"
        },
        {
          "pattern": "\\b(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}\\b",
          "flags": "g",
          "message": "检测到可能的 AWS 访问密钥"
        },
        {
          "pattern": "\\b[\\w-]+\\.(?:pem|key|cert|crt)\\b",
          "flags": "gi",
          "message": "检测到可能的密钥文件引用"
        },
        {
          "pattern": "\\bbearer\\s+[a-zA-Z0-9._~+/=\\-]{20,}\\b",
          "flags": "gi",
          "message": "检测到可能的 Bearer Token"
        },
        {
          "pattern": "\\bgh[pous]_[A-Za-z0-9_]{36,}\\b",
          "flags": "g",
          "message": "检测到可能的 GitHub Token"
        },
        {
          "pattern": "\\bsk-[a-zA-Z0-9]{20,}\\b",
          "flags": "gi",
          "message": "检测到可能的 Stripe API 密钥"
        },
        {
          "pattern": "\\bAIza[A-Za-z0-9_\\-]{35}\\b",
          "flags": "g",
          "message": "检测到可能的 Google API 密钥"
        },
        {
          "pattern": "\\b[xX]ox[bap]-[A-Za-z0-9\\-]{10,}\\b",
          "flags": "gi",
          "message": "检测到可能的 Slack Token"
        },
        {
          "pattern": "\\bPKCS[0-9]\\b",
          "flags": "gi",
          "message": "检测到可能的加密相关常量"
        }
      ]
    }
  }
}
