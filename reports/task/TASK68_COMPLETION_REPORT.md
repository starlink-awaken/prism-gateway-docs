# Task 68: CLIæ¥å£å’Œç«¯åˆ°ç«¯æµ‹è¯• - å®ŒæˆæŠ¥å‘Š

## å®æ–½æ€»ç»“

### 1. CLIå·¥å…·å®ç° (`src/cli/index.ts`)

ä½¿ç”¨Commander.jså®ç°äº†å®Œæ•´çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒä»¥ä¸‹å‘½ä»¤ï¼š

| å‘½ä»¤ | æè¿° | é€‰é¡¹ |
|------|------|------|
| `prism check <intent>` | æ£€æŸ¥ä»»åŠ¡æ„å›¾æ˜¯å¦ç¬¦åˆGatewayåŸåˆ™ | `--format` (text/json/markdown), `--verbose` |
| `prism retro [mode]` | æ‰§è¡Œå¤ç›˜åˆ†æ | `--project`, `--format`, `--phase` |
| `prism status` | æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€ | `--verbose`, `--format` |
| `prism stats` | æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯ | `--format` |
| `prism principles` | åˆ—å‡ºæ‰€æœ‰åŸåˆ™ | `--format` |
| `prism patterns [keyword]` | æœç´¢æ¨¡å¼ | `--type`, `--format` |

### 2. ç«¯åˆ°ç«¯æµ‹è¯• (`src/tests/e2e.test.ts`)

å®ç°äº†33ä¸ªç«¯åˆ°ç«¯æµ‹è¯•ç”¨ä¾‹ï¼Œè¦†ç›–ï¼š

- **åŸºç¡€å‘½ä»¤æµ‹è¯•**: å¸®åŠ©ä¿¡æ¯ã€ç‰ˆæœ¬ä¿¡æ¯
- **checkå‘½ä»¤æµ‹è¯•**: æ„å›¾æ£€æŸ¥ã€è¿è§„æ£€æµ‹ã€JSONè¾“å‡º
- **retroå‘½ä»¤æµ‹è¯•**: å¿«é€Ÿ/æ ‡å‡†å¤ç›˜ã€é¡¹ç›®IDã€è¾“å‡ºæ ¼å¼
- **statuså‘½ä»¤æµ‹è¯•**: ç³»ç»ŸçŠ¶æ€ã€ç»„ä»¶çŠ¶æ€
- **statså‘½ä»¤æµ‹è¯•**: ç»Ÿè®¡ä¿¡æ¯ã€JSONè¾“å‡º
- **é”™è¯¯å¤„ç†æµ‹è¯•**: æ— æ•ˆå‘½ä»¤ã€æ— æ•ˆæ¨¡å¼ã€ç¼ºå¤±å‚æ•°
- **é›†æˆåœºæ™¯æµ‹è¯•**: å®Œæ•´æ£€æŸ¥-å¤ç›˜æµç¨‹ã€æ‰¹é‡æ£€æŸ¥
- **è¾“å‡ºæ ¼å¼æµ‹è¯•**: text/json/markdown
- **æ€§èƒ½æµ‹è¯•**: check <1ç§’ã€å¿«é€Ÿå¤ç›˜ <10ç§’
- **æ ¸å¿ƒåŠŸèƒ½é›†æˆæµ‹è¯•**: MemoryStoreã€GatewayGuardã€RetrospectiveCoreã€DataExtractor

### 3. æµ‹è¯•ç»“æœ

```
ğŸ“Š æµ‹è¯•ç»Ÿè®¡
- æ€»æµ‹è¯•æ•°: 203
- é€šè¿‡: 203 âœ…
- å¤±è´¥: 0
- è¦†ç›–ç‡: >80% âœ…
```

### 4. é…ç½®æ›´æ–°

**package.json:**
- æ·»åŠ äº† `bin` å…¥å£ç‚¹: `"prism": "src/cli/index.ts"`
- æ·»åŠ äº† `commander` ä¾èµ–
- æ·»åŠ äº†æµ‹è¯•è„šæœ¬: `test:e2e`, `test:unit`

### 5. æ–‡æ¡£æ›´æ–°

README.md æ–°å¢å†…å®¹:
- CLIä½¿ç”¨è¯´æ˜
- è¾“å‡ºæ ¼å¼é€‰é¡¹
- é¡¹ç›®çŠ¶æ€æ›´æ–°

## æŠ€æœ¯è¦ç‚¹

### æµ‹è¯•æ¨¡å¼æ”¯æŒ

å®ç°äº† `PRISM_TEST_MODE` ç¯å¢ƒå˜é‡æ§åˆ¶ï¼Œåœ¨æµ‹è¯•æ¨¡å¼ä¸‹ï¼š
- `process.exit()` è¢«ç¦ç”¨ï¼Œé¿å…æµ‹è¯•æ¡†æ¶ä¸­æ–­
- é”™è¯¯ä¿¡æ¯é€šè¿‡stderræ£€æµ‹æ¥åˆ¤æ–­exitCode

### è¾“å‡ºæ ¼å¼åŒ–

å®ç°äº† `OutputFormatter` ç±»æ”¯æŒä¸‰ç§è¾“å‡ºæ ¼å¼ï¼š
- **text**: äººç±»å¯è¯»çš„çº¯æ–‡æœ¬
- **json**: æœºå™¨å¯è¯»çš„JSONæ ¼å¼
- **markdown**: æ–‡æ¡£å‹å¥½çš„Markdownæ ¼å¼

### æ—¥å¿—æ§åˆ¶

åœ¨JSONè¾“å‡ºæ¨¡å¼ä¸‹ç¦ç”¨console.logï¼Œç¡®ä¿è¾“å‡ºçº¯å‡€çš„JSONã€‚

## éªŒè¯æ­¥éª¤

1. **å®‰è£…ä¾èµ–**
```bash
cd ~/.reflectguard && bun install
```

2. **è¿è¡Œæµ‹è¯•**
```bash
bun test                    # è¿è¡Œæ‰€æœ‰æµ‹è¯•
bun run test:e2e           # è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
```

3. **ä½¿ç”¨CLI**
```bash
# æ£€æŸ¥ä»»åŠ¡æ„å›¾
bun run src/cli/index.ts check "å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½"

# æ‰§è¡Œå¤ç›˜
bun run src/cli/index.ts retro quick --project my-project

# æŸ¥çœ‹çŠ¶æ€
bun run src/cli/index.ts status

# æŸ¥çœ‹ç»Ÿè®¡
bun run src/cli/index.ts stats
```

## äº¤ä»˜ç‰©

1. âœ… `src/cli/index.ts` - CLIå·¥å…·ä¸»æ–‡ä»¶
2. âœ… `src/tests/e2e.test.ts` - ç«¯åˆ°ç«¯æµ‹è¯•å¥—ä»¶
3. âœ… `package.json` - æ›´æ–°é…ç½®
4. âœ… `README.md` - CLIä½¿ç”¨æ–‡æ¡£

## çŠ¶æ€: å®Œæˆ âœ…

Task 68 å·²æˆåŠŸå®Œæˆï¼Œæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ŒCLIå·¥å…·åŠŸèƒ½å®Œæ•´å¯ç”¨ã€‚
