# 复盘标准操作流程 (Retrospective SOP)

> 从 7 个维度全面复盘，持续改进和知识积累

**版本：** 1.0.0
**生效日期：** 2026-02-07
**适用范围：** 所有重要任务和事件
**审核周期：** 每季度

---

## 📋 复盘类型

| 类型 | 时机 | 时长 | 参与人 |
|------|------|------|--------|
| **快速复盘** | 日常任务完成后 | 5-10 分钟 | 个人 |
| **标准复盘** | 重要任务/里程碑完成后 | 30-60 分钟 | 团队 |
| **深度复盘** | Phase/项目完成后 | 2-4 小时 | 全员 + 外部专家 |

---

## 🎯 7 维度复盘框架

```
┌─────────────────────────────────────────────────────────────┐
│                    7 维度复盘框架                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  1️⃣  原则 (Principles)  - 违反了哪些行为准则？              │
│  2️⃣  模式 (Patterns)    - 匹配了哪些成功/失败模式？         │
│  3️⃣  基准 (Benchmarks)  - 能力评估如何？                    │
│  4️⃣  陷阱 (Traps)       - 遇到了哪些常见陷阱？              │
│  5️⃣  成功 (Success)     - 成功因素是什么？                  │
│  6️⃣  工具 (Tools)       - 使用了哪些工具和技术？            │
│  7️⃣  数据 (Data)        - 关键数据点是什么？                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 🚀 快速复盘流程（5-10 分钟）

### 适用场景
- 日常开发任务完成
- Bug 修复完成
- 小型功能发布

### 执行步骤

**1. 启动复盘**
```bash
bun run src/cli/index.ts retro quick
```

**2. 回答 7 个维度的问题**

#### 1️⃣ 原则 (Principles)
> 是否违反了任何行为准则？

- [ ] P1: 搜索优先原则 - 遇到问题先搜索了吗？
- [ ] P2: 验证真实原则 - 验证了实际功能吗？
- [ ] P3: 不重复失败原则 - 避免了盲目重试吗？
- [ ] P4: 数据准确性原则 - 数据异常调查了吗？
- [ ] P5: 用户期望原则 - 明确用户期望了吗？

#### 2️⃣ 模式 (Patterns)
> 匹配了哪些已知模式？

**成功模式：**
- [ ] 文件系统优先模式
- [ ] 类型安全开发模式
- [ ] 测试驱动开发模式
- [ ] 知识库分层结构

**失败模式：**
- [ ] 重复操作失败模式
- [ ] 错误信息忽略模式
- [ ] 功能验证缺失模式

#### 3️⃣ 基准 (Benchmarks)
> 性能和质量如何？

- **完成时间：** 预计 ___ 小时，实际 ___ 小时
- **代码质量：** 测试覆盖率 ___%, Lint 通过 ✅/❌
- **效率评分：** ⭐⭐⭐⭐⭐ (1-5 星)

#### 4️⃣ 陷阱 (Traps)
> 遇到了哪些常见陷阱？

- [ ] 过度优化陷阱
- [ ] 功能蔓延陷阱
- [ ] 技术债务陷阱
- [ ] 沟通不足陷阱

#### 5️⃣ 成功 (Success)
> 成功因素是什么？

**做得好的地方：**
1. [列出 1-3 个亮点]
2. ...

#### 6️⃣ 工具 (Tools)
> 使用了哪些工具？

- **开发工具：** VSCode, Bun, Git
- **测试工具：** Bun Test
- **协作工具：** GitHub, Slack

#### 7️⃣ 数据 (Data)
> 关键数据点？

- **代码行数：** +___ / -___
- **测试数量：** ___
- **Bug 修复：** ___

**3. 生成复盘报告**

系统自动生成报告并存储到：
```
level-2-warm/retros/YYYY-MM/quick/retro-YYYYMMDD-HHMMSS.json
```

---

## 📊 标准复盘流程（30-60 分钟）

### 适用场景
- 重要功能完成
- 里程碑达成
- 故障事件复盘

### 执行步骤

**1. 复盘准备（10 分钟）**

```bash
# 启动复盘
bun run src/cli/index.ts retro standard

# 收集数据
# - Git 提交历史
# - 测试报告
# - 性能数据
# - 违规记录
```

**2. 7 维度深度分析（30 分钟）**

#### 1️⃣ 原则分析
```bash
# 查看违规记录
cat level-2-warm/violations.jsonl | jq '.'

# 分析违规趋势
bun run src/cli/index.ts stats --metrics violations
```

**问题：**
- 违反了哪些原则？
- 违规原因是什么？
- 如何预防再次违规？

#### 2️⃣ 模式识别
```bash
# 查看匹配的模式
cat level-1-hot/patterns/success_patterns.json
cat level-1-hot/patterns/failure_patterns.json
```

**问题：**
- 重复了哪些成功模式？
- 遇到了哪些失败模式？
- 可以提炼新的模式吗？

#### 3️⃣ 基准评估
```bash
# 查看性能数据
bun run src/cli/index.ts stats --metrics performance

# 查看质量数据
bun run src/cli/index.ts stats --metrics quality
```

**评估维度：**
- 开发效率：计划 vs 实际时间
- 代码质量：测试覆盖率、Lint 通过率
- 功能完整度：需求实现比例

#### 4️⃣ 陷阱总结

**常见陷阱清单：**
- [ ] 过度设计
- [ ] 技术选型不当
- [ ] 沟通断层
- [ ] 需求理解偏差
- [ ] 测试不充分

#### 5️⃣ 成功因素提取

**STAR 分析法：**
- **S**ituation: 任务背景
- **T**ask: 任务目标
- **A**ction: 采取的行动
- **R**esult: 取得的成果

#### 6️⃣ 工具评估

**工具效能评分：**
| 工具 | 使用频率 | 效率评分 | 改进建议 |
|------|----------|----------|----------|
| Bun | 高 | ⭐⭐⭐⭐⭐ | 无 |
| GitHub | 高 | ⭐⭐⭐⭐ | 改进 PR 流程 |

#### 7️⃣ 数据总结

**量化指标：**
```json
{
  "codeLines": {
    "added": 1500,
    "deleted": 200
  },
  "tests": {
    "added": 50,
    "coverage": 92
  },
  "performance": {
    "before": "200ms",
    "after": "150ms",
    "improvement": "25%"
  }
}
```

**3. 行动计划（10 分钟）**

**改进措施：**
- [ ] 短期（1 周内）：[具体行动]
- [ ] 中期（1 月内）：[具体行动]
- [ ] 长期（1 季度内）：[具体行动]

**4. 知识沉淀（10 分钟）**

- [ ] 更新原则（如需要）
- [ ] 添加新模式（如发现）
- [ ] 更新 SOP（如优化）
- [ ] 分享最佳实践

---

## 🎓 深度复盘流程（2-4 小时）

### 适用场景
- Phase/项目完成
- 重大故障事件
- 季度/年度总结

### 执行步骤

**1. 准备阶段（30 分钟）**
- 收集所有数据和文档
- 邀请所有参与者
- 准备会议室和设备

**2. 深度分析（2 小时）**
- 逐个维度深入讨论
- 邀请外部专家参与
- 使用数据可视化工具

**3. 战略规划（1 小时）**
- 制定长期改进计划
- 分配责任人和时间表
- 设定可衡量的目标

**4. 知识库更新（30 分钟）**
- 更新核心原则
- 完善模式库
- 编写案例研究
- 更新培训材料

---

## 📝 复盘报告模板

详见：[复盘报告模板](../templates/retro-report.md)

---

## 🔄 复盘频率建议

| 角色 | 快速复盘 | 标准复盘 | 深度复盘 |
|------|----------|----------|----------|
| **工程师** | 每日 | 每周 | 每 Phase |
| **团队 Lead** | 每周 | 每 2 周 | 每 Phase |
| **管理层** | 每月 | 每月 | 每季度 |

---

## 📊 复盘效果评估

### 评估指标

| 指标 | 计算方式 | 目标 |
|------|----------|------|
| **复盘执行率** | 实际复盘次数 / 应复盘次数 | >90% |
| **违规下降率** | (本月违规 - 上月违规) / 上月违规 | <-10% |
| **知识增长率** | 新增模式/原则数量 | >2 个/月 |

---

## 🔗 相关资源

- [7 维度复盘框架文档](../../docs/RETROSPECTIVE_FRAMEWORK.md)
- [复盘报告模板](../templates/retro-report.md)
- [模式库](../../level-1-hot/patterns/)

---

**审核人：** 质量评估和验收组
**批准人：** PMO
**下次审核日期：** 2026-05-07
