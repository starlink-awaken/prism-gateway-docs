# PRISM-Gateway 六组织协作框架 - 轻量级实施指南

**版本：** 2.1（轻量级）
**创建日期：** 2026-02-04
**适用场景：** 小型项目团队（1-3 人），需要结构化协作但不希望过度设计

---

## 核心原则

### 精益协作原则

1. **按需启动** - 组织只在需要时才启动，不强制要求所有组织同时运行
2. **AI 主导** - AI 组织制定详细计划，用户（隔壁老王）审核确认后执行
3. **轻量级** - 每个组织最小化配置，避免官僚化
4. **目标导向** - 所有组织活动以达成项目目标为核心，不为组织而组织

### 组织定位

| 组织 | 主要职责 | 启动条件 | 规模 | 预期投入 |
|------|---------|---------|------|---------|
| **项目管理组** | 进度跟踪、风险管理、决策协调 | 项目启动或复杂决策开始 | 1人（兼职） | 5% 时间 |
| **实施组** | 代码开发、测试、功能实现 | 有明确开发任务时 | 1-2人 | 80% 时间 |
| **质量评估和验收组** | 代码审查、测试验证、质量门禁 | 开发任务完成后，或需要质量保障时 | 1人（兼职） | 10% 时间 |
| **复盘及规划组** | 里程碑复盘、经验总结、规划调整 | 里程碑节点或需要方向调整时 | 按需启动 | 临时 |
| **顾问组** | 领域专家咨询、技术难题攻关 | 遇到特定技术难题时 | 按需邀请 | 临时 |
| **专业架构师组** | 架构设计、技术选型、重大决策评审 | 架构变更或技术决策时 | 按需启动 | 临时 |

---

## 协作模式

### AI 主导 + 用户确认流程

```
1. AI 组织分析任务
   ↓
2. AI 组织制定详细计划
   ├─ Architect 设计架构
   ├─ Engineer 规划实现
   ├─ Algorithm 评估质量
   └─ Planner 制定时间表
   ↓
3. 用户（隔壁老王）审核确认
   ├─ 通过 → 执行
   ├─ 修改 → AI 组织重新规划
   └─ 否决 → 终止任务
   ↓
4. 执行并持续改进
```

### 按需启动机制

**自动启动触发条件：**
- **项目管理组：** 项目启动时自动启动，持续运行
- **实施组：** 有开发任务时自动启动，任务完成后休眠
- **质量评估组：** 开发任务完成后自动启动，进行 Code Review

**手动启动触发条件：**
- **复盘及规划组：** 里程碑节点（Week/Milestone 完成时）
- **顾问组：** 遇到技术难题或需要领域专家意见时
- **专业架构师组：** 架构变更、技术选型、重大决策评审

---

## 组织章程

### 项目管理组（PMG）

**职责：**
- 维护项目 Backlog 和优先级
- 跟踪进度，识别风险
- 协调各组织间的协作
- 组织决策会议，记录决策结果

**工作模式：**
- 使用 Trello/GitHub Projects 管理任务
- 每日站会（5-10 分钟）同步进度
- 每周总结（周五下午）

**关键产出：**
- 项目进度报告（每周）
- 风险检查清单（每次决策前）
- 里程碑报告（关键节点）

**核心工具：**
- GitHub Projects（看板管理）
- Discord/Slack（日常沟通）
- 文档化决策（DECISIONS.md）

---

### 实施组（Implementation Group）

**职责：**
- 功能开发（Skills + Agents + Workflows）
- 代码实现和测试
- 文档编写
- Bug 修复

**工作模式：**
- TDD 开发流程（红-绿-重构）
- Code Review 机制（提交前）
- 持续集成（每次提交自动测试）

**核心工具：**
- Bun（运行时）
- TypeScript（语言）
- Git + GitHub（版本控制）
- Bun Test（测试框架）

**质量标准：**
- 测试覆盖率 >85%
- 所有代码必须有 Code Review
- 遵循 SOLID 原则

---

### 质量评估和验收组（Quality Group）

**职责：**
- 代码审查（Code Review）
- 测试验证（集成测试、E2E 测试）
- 质量门禁检查
- 性能基准验证

**工作模式：**
- 每个 Pull Request 必须 Code Review
- 集成测试通过后才合并代码
- 定期性能测试（每周）

**核心工具：**
- GitHub Pull Request Review
- Bun Test（自动化测试）
- 性能基准测试脚本

**验收标准：**
- 代码规范检查通过
- 测试覆盖率达标
- 性能指标符合要求
- 文档完整

---

### 复盘及规划组（Retrospective Group）

**职责：**
- 里程碑复盘
- 经验总结（成功要素、失败原因、改进领域）
- 下阶段规划调整
- 技术债务管理

**工作模式：**
- 里程碑复盘会议（如 Phase 1 完成）
- 使用 QuickReview 或 Standard Retro 工具
- 生成复盘报告
- 更新风险检查清单

**复盘框架（7 维度）：**
1. 原则 - 违反了哪些行为准则
2. 模式 - 成功/失败模式识别
3. 基准 - 能力评估指标
4. 陷阱 - 识别的常见问题
5. 成功 - 成功因素提取
6. 工具 - 使用的工具和技术
7. 数据 - 关键数据点

**核心产出：**
- 复盘报告（里程碑节点）
- 技术债务清单
- 下一阶段计划

---

### 顾问组（Advisory Group）

**职责：**
- 领域专家咨询（如 CLI 设计、MCP 协议、并发编程）
- 技术难题攻关（如性能优化、架构设计）
- 最佳实践建议

**工作模式：**
- 按需邀请（不常驻）
- 临时技术咨询会议
- 异步问题解答

**核心工具：**
- Claude Code（日常咨询）
- 领域专家资源（外部文档、社区）

**顾问领域：**
- CLI 设计（Commander.js、Yargs）
- MCP 协议（Model Context Protocol）
- 并发编程（FileLock、异步模式）
- TypeScript 类型系统
- 测试策略（TDD、集成测试）

---

### 专业架构师组（Architect Group）

**职责：**
- 架构设计（系统架构、模块划分）
- 技术选型（框架、库、工具）
- 重大决策评审（PR 审核）
- 技术标准制定

**工作模式：**
- 架构变更时启动
- 重大技术决策前评审
- 按需咨询
- 架构文档评审

**核心工具：**
- C4 Model（架构文档）
- ADR（Architecture Decision Records）
- 技术标准文档

**决策流程：**
1. Architect 组织设计讨论
2. 生成架构提案（包括多个选项）
3. 用户审核确认
4. 记录决策到 ADR

---

## 协作流程

### 1. 任务启动流程

```
用户提出需求
    ↓
项目管理组评估需求，记录到 Backlog
    ↓
判断任务类型：
├─ 简单任务 → 直接分配给实施组
├─ 架构变更 → 启动专业架构师组
├─ 质量问题 → 启动质量评估组
└─ 里程碑节点 → 启动复盘及规划组
    ↓
AI 组织制定计划
  ├─ Architect 设计架构（如需要）
  ├─ Engineer 规划实现方案
  ├─ Algorithm 评估质量标准
  └─ Planner 制定时间表和资源需求
    ↓
用户审核确认
    ↓
执行并跟踪
```

### 2. 日常协作流程

**每日站会（5-10 分钟）：**
- 昨天完成的工作
- 今天计划做什么
- 遇到的问题和阻碍
- 需要帮助的资源

**每周总结（周五下午）：**
- 本周完成的功能
- 测试结果和质量指标
- 遇到的挑战和解决方案
- 下周计划调整

**里程碑复盘（关键节点）：**
- 目标达成情况
- 成功要素提取
- 失败原因分析
- 改进建议
- 下阶段规划

### 3. 质量门禁流程

```
开发完成
    ↓
质量评估组 Code Review
    ├─ 代码规范检查 ✅
    ├─ 测试覆盖率验证 ✅
    ├─ 性能基准测试 ✅
    └─ 文档完整性检查 ✅
    ↓
合并代码
    ↓
持续集成测试验证
    ↓
部署（如需要）
```

---

## 工具和基础设施

### 项目管理工具

**GitHub Projects 看板：**
```
Columns:
├─ Backlog（待办）
├─ In Progress（进行中）
├─ In Review（代码审查中）
├─ Testing（测试中）
└─ Done（已完成）
```

**标签系统：**
- priority: P0, P1, P2, P3
- type: feature, bug, refactor, test, docs
- component: Skills, Agents, Workflows, Tools, MCP, Plugins
- milestone: Phase1, Phase2, Week1, Week2, etc.

### 协作工具

**日常沟通：**
- GitHub Issues（问题跟踪）
- GitHub Discussions（技术讨论）
- Pull Request Review（代码审查）
- Commit Messages（变更记录）

**文档协作：**
- Markdown 文档（.md 文件）
- 架构决策记录（ADR/）
- 复盘报告（RETRO/）

---

## 按需启动示例

### 场景 1：开始 Analytics 模块开发

**启动组织：**
- ✅ 项目管理组（持续运行）
- ✅ 实施组（启动，2 名工程师）
- ⏸️ 质量评估组（待任务完成后）
- ⏸️ 复盘及规划组（待里程碑）
- ⏸️ 顾问组（按需）
- ⏸️ 专业架构师组（需要架构设计时启动）

**流程：**
1. 用户提出"开始 Analytics 模块开发"
2. 项目管理组记录到 Backlog
3. 专业架构师组启动（设计 Analytics 架构）
4. 实施组启动（执行开发）
5. 质量评估组按需启动（Code Review）

### 场景 2：项目重构

**启动组织：**
- ✅ 项目管理组（启动，协调重构工作）
- ✅ 实施组（启动，执行重构）
- ✅ 专业架构师组（启动，设计新架构）
- ⏸️ 质量评估组（按需启动）
- ⏸️ 复盘及规划组（重构完成后启动）

**流程：**
1. 用户提出"开始项目重构"
2. 项目管理组组织需求分析
3. 专业架构师组设计新架构
4. 实施组执行重构
5. 质量评估组验证重构质量
6. 复盘及规划组总结重构经验

---

## KPI 和质量指标

### 项目级 KPI

| 指标 | 目标 | 测量方式 |
|------|------|---------|
| 功能完成度 | 按计划达成 | 里程碑对比 |
| 代码质量 | >85% 覆盖率 | Bun Test coverage |
| 性能指标 | 响应时间 <100ms | 性能基准测试 |
| 文档完整性 | 所有公开 API 有文档 | 文档检查 |
| 缺陷率 | <5 个 P0/P1 缺陷 | Bug 跟踪 |

### 组织级 KPI

| 组织 | KPI | 测量方式 |
|------|-----|---------|
| PMG | 进度偏差 <20% | 计划 vs 实际对比 |
| 实施组 | 交付频率 | 每周功能交付数量 |
| 质量组 | Review 响应时间 | PR 平均等待时间 |
| 复盘组 | 复盘质量 | 复盘报告完整性 |

---

## 沟通机制

### 会议节奏

| 会议类型 | 频率 | 参与者 | 时长 |
|---------|------|--------|------|
| 每日站会 | 每日 09:00 | 全体 | 5-10 分钟 |
| 每周总结 | 每五 16:00 | 全体 | 30-60 分钟 |
| 里程碑复盘 | 里程碑节点 | 全体 | 60-90 分钟 |
| 专项讨论会 | 按需 | 相关组织 | 30 分钟 |

### 决策流程

**小型决策（不影响架构）：**
1. 实施组直接决策
2. 记录到 Git commit message
3. 通知项目管理组

**中型决策（影响多个模块）：**
1. 专业架构师组评审
2. 提供多个选项和风险分析
3. 用户最终决策
4. 记录到 ADR

**重大决策（改变项目方向）：**
1. 六组织（或相关组织）集体讨论
2. 多个方案对比分析（Council 模式）
3. Algorithm 组评估可行性
4. 用户最终决策
5. 记录决策文档和 ADR

---

## 风险管理

### 常见风险

| 风险类型 | 识别方式 | 应对措施 |
|---------|---------|---------|
| 需求不明确 | 用户需求模糊 | 项目管理组澄清，记录到文档 |
| 技术债务累积 | Code Review 遗漏 | 质量评估组审查，定期重构 |
| 进度延误 | 每日站会发现 | 项目管理组调整优先级 |
| 沟通不畅 | 信息不同步 | 每周总结同步 |
| 质量下降 | 测试失败率上升 | 质量评估组加强 Code Review |

### 风险升级机制

| 风险等级 | 应对措施 |
|---------|---------|
| P3（低） | 记录风险，持续观察 |
| P2（中） | 项目管理组跟踪，调整计划 |
| P1（高） | 启动专业架构师组评估 |
| P0（严重） | 六组织紧急会议，集体决策 |

---

## 快速启动检查清单

### 启动新任务时检查

- [ ] 任务已记录到 Backlog
- [ ] 优先级已明确（P0/P1/P2/P3）
- [ ] 相关组织已通知
- [ ] AI 组织已制定计划
- [ ] 用户已审核确认
- [ ] 验收标准已定义

### 里程碑复盘检查清单

- [ ] 目标达成情况评估
- [ ] 成功要素提取（至少 3 个）
- [ ] 失败原因分析（至少 2 个）
- [ ] 改进建议总结（至少 2 个）
- [ ] 下一阶段计划制定
- [ ] 复盘报告已生成

---

## 成功案例模板

### 案例 1：Analytics 模块开发

**启动组织：** PMG + 实施组 + 架构师组

**流程：**
1. 用户需求："实现 Analytics 模块的数据聚合功能"
2. PMG 记录到 Backlog，标记为 P1
3. 架构师组启动，设计 Analytics 架构（2 天）
4. 用户审核架构设计
5. 实施组启动，开发功能（1 周）
6. 质量评估组 Code Review（持续进行）
7. 测试验证通过后合并代码
8. 里程碑复盘

**结果：** 功能按时交付，质量达标

---

### 案例 2：项目重构

**启动组织：** PMG + 实施组 + 架构师组 + 复盘组

**流程：**
1. 用户需求："重构项目结构，解决'太乱了'问题"
2. PMG 组织需求分析（1 天）
3. 架构师组设计新架构（3 天）
4. 用户审核新架构
5. 实施组执行重构（2 周）
6. 质量评估组验证重构质量
7. 复盘组总结重构经验
8. 更新文档和指南

**结果：** 项目结构清晰，文档完善

---

## 附录

### A. 组织角色定义

**项目管理组（PMG）：**
- Project Manager：维护项目计划和优先级
- Risk Officer：识别和管理项目风险

**实施组：**
- Engineer：核心开发人员
- Developer：辅助开发工作

**质量评估和验收组：**
- Code Reviewer：代码审查
- QA Engineer：测试验证

**复盘及规划组：**
- Facilitator：组织复盘会议
- Recorder：记录复盘内容
- Planner：制定下阶段计划

**顾问组：**
- Domain Experts：领域专家
- Technical Advisors：技术顾问

**专业架构师组：**
- System Architect：系统架构师
- Technical Architect：技术架构师

### B. 工具使用指南

**GitHub Projects 配置：**
- Board 名称：PRISM-Gateway Kanban
- Columns：To Do, In Progress, In Review, Testing, Done
- Labels：priority, type, component, milestone

**ADR 模板：**
```markdown
# ADR-001: 采用 SHARED 锁实现

## 状态
已接受

## 上下文
PRISM-Gateway 需要支持并发读取操作，当前的锁机制性能不足。

## 决策
采用 FileLock 实例唯一化 + SHARED 锁文件机制，实现真正的多读单写。

## 后果
- 性能提升 8.7 倍
- 测试通过率 100%
- 需要额外的测试清理逻辑

## 替代方案
- 使用现有的读写锁库（不支持跨平台）
- 降级为单一锁模式（性能下降）
```

---

**文档版本：** 2.1（轻量级）
**最后更新：** 2026-02-04
**维护者：** PRISM-Gateway Team
